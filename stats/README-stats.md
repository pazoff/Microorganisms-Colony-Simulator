# Microorganisms Colony Simulator Log Analyzer

The **Microorganisms Colony Simulator Log Analyzer** is a Python script (`stats.py`) designed to parse and visualize simulation logs generated by the **Microorganisms Colony Simulator** web application. Using **Matplotlib**, it processes log files to extract biomass and energy data for each microbial species and instance, calculates averages over time, and generates two line plots: one for average biomass and one for average energy. This tool is useful for researchers, educators, or enthusiasts analyzing microbial simulation outcomes offline.

This script complements the main simulator by providing a standalone method to visualize simulation results, making it easier to study trends and compare species performance without relying on the web interface's real-time plotting.

## Features

- **Log Parsing**: Reads simulation log files to extract timestamped events (growth, waste penalties, reproduction, death, consumption).
- **Data Extraction**: Identifies species, instance IDs, biomass, and energy values from log entries using regular expressions.
- **Average Calculation**: Computes average biomass and energy per species over time, considering only active (alive) instances.
- **Visualization**: Generates two Matplotlib line plots:
  - **Average Biomass Over Time**: Shows biomass trends for each species.
  - **Average Energy Over Time**: Shows energy trends for each species.
- **Color-Coded Plots**: Assigns distinct colors to species for clear differentiation (with a fallback for excess species).
- **Error Handling**: Gracefully handles file not found errors and parsing issues with informative messages.
- **Command-Line Interface**: Accepts a log file as input via command-line argument for easy integration into workflows.

## Installation

1. **Clone the Repository**:
   Ensure you have the main **Microorganisms Colony Simulator** repository or the log analyzer script. If not, clone it:
   ```bash
   git clone https://github.com/yourusername/Microorganisms-Colony-Simulator.git
   cd Microorganisms-Colony-Simulator
   ```

2. **Install Dependencies**:
   The script requires Python 3 and the following libraries:
   - **Matplotlib**: For plotting.
   Install it using pip:
   ```bash
   pip install matplotlib
   ```

3. **Prepare a Log File**:
   - Run the **Microorganisms Colony Simulator** web application and copy the simulation log from the UI's log box (click to copy to clipboard).
   - Paste the log into a text file (e.g., `simulation.log`) and save it in the same directory as `stats.py`.

## Usage

1. **Run the Script**:
   Execute the script from the command line, providing the path to the log file:
   ```bash
   python stats.py simulation.log
   ```
   Replace `simulation.log` with the name of your log file.

2. **View the Plots**:
   - The script will parse the log file and display two Matplotlib plots:
     - **Top Plot**: Average biomass over time for each species.
     - **Bottom Plot**: Average energy over time for each species.
   - Each species is represented by a unique color, with a legend for identification.

3. **Interpret the Results**:
   - Analyze trends in biomass and energy to understand species performance, competition, or environmental impacts.
   - Use the time axis (in seconds) to correlate events with simulation parameters.

## File Structure

- **stats.py**: The Python script for parsing and plotting simulation logs.
- **simulation.log** (example): A user-provided log file containing simulation events (not included in the repository).

## Function Descriptions

Below is a detailed description of the functions in `stats.py`, organized by their purpose.

### Utility Functions

- **`timestamp_to_seconds(timestamp, start_time)`**:
  - Converts a timestamp string (format `[HH:MM:SS]`) to seconds since the simulation's start time.
  - Parameters:
    - `timestamp` (str): Timestamp string (e.g., `[12:34:56]`).
    - `start_time` (datetime): The simulation's start time.
  - Returns:
    - `float`: Seconds elapsed since `start_time`.

### Core Processing Functions

- **`parse_log_file(filename)`**:
  - Reads and parses a simulation log file to extract species, instance, biomass, and energy data.
  - Parameters:
    - `filename` (str): Path to the log file.
  - Returns:
    - `species_data` (dict): Nested dictionary `{species: {instance: [(time, biomass, energy)]}}`.
    - `time_points` (list): Sorted list of unique time points (in seconds).
    - `start_time` (datetime): The simulation's start time.
    - `species_names` (list): Sorted list of unique species names.
  - Behavior:
    - Uses regular expressions to match timestamps, species-instance pairs, and event types (growth, waste, reproduction, death, consumption).
    - Handles events by updating `species_data` and tracking species names and time points.
    - Removes dead instances from `species_data` after death events.
    - Exits with an error message if the file is not found or parsing fails.

- **`calculate_averages(species_data, time_points, species_names)`**:
  - Computes average biomass and energy per species at each time point, considering only alive instances (energy > 0).
  - Parameters:
    - `species_data` (dict): Parsed data from `parse_log_file`.
    - `time_points` (list): Sorted time points.
    - `species_names` (list): Sorted species names.
  - Returns:
    - `avg_biomass` (dict): `{species: [average_biomass_at_time_t]}`.
    - `avg_energy` (dict): `{species: [average_energy_at_time_t]}`.
  - Behavior:
    - Iterates through time points and species, finding the latest data point for each instance.
    - Averages biomass and energy across alive instances; returns 0 if no alive instances exist.

- **`plot_data(time_points, avg_biomass, avg_energy, species_names)`**:
  - Generates Matplotlib line plots for average biomass and energy over time.
  - Parameters:
    - `time_points` (list): Sorted time points.
    - `avg_biomass` (dict): Average biomass data.
    - `avg_energy` (dict): Average energy data.
    - `species_names` (list): Sorted species names.
  - Behavior:
    - Creates a figure with two subplots (biomass and energy).
    - Assigns a color to each species from a predefined list (`blue`, `red`, etc.), with a warning if more species exist than colors.
    - Plots lines for each species, adds labels, titles, legends, and grids.
    - Displays the plots using `plt.show()`.

### Main Execution

- **`if __name__ == "__main__":`**:
  - Entry point for the script.
  - Checks for a command-line argument (log file name).
  - Calls `parse_log_file`, `calculate_averages`, and `plot_data` in sequence.
  - Exits with usage instructions if no file is provided.

## Example Log File Format

The log file should contain entries like:
```
[12:34:56] species1-0 Grown to Size: 1.00 Energy: 100.00 Biomass: 10.00
[12:34:57] species1-0 -0.5 energy down by waste! Energy: 99.50 Biomass: 10.00
[12:34:58] species1-0 Reproduced. Spawning species1-1 Energy: 90.00 Biomass: 5.00
[12:34:59] species2-0 has died: Energy: 0.00 Biomass: 0.00
[12:35:00] species1-0 Consumed by species2-1: New Energy: 110.00 Biomass: 15.00
```

- Each line starts with a timestamp `[HH:MM:SS]`.
- Events include growth, waste penalties, reproduction, death, or consumption.
- Species and instance IDs are formatted as `speciesName-instanceNumber`.

## Contributing

Contributions to improve the log analyzer are welcome! To contribute:

1. Fork the repository.
2. Create a new branch (`git checkout -b feature/your-feature`).
3. Make changes to `stats.py` or add new scripts, ensuring compatibility with the simulator's log format.
4. Update documentation in this README if necessary.
5. Commit changes (`git commit -m 'Add your feature'`).
6. Push to the branch (`git push origin feature/your-feature`).
7. Open a pull request with a detailed description.

Please ensure code follows PEP 8 style guidelines and includes comments for clarity.

## Future Improvements

- **Customizable Colors**: Allow users to specify species colors via a configuration file or command-line arguments.
- **Output Options**: Save plots as PNG/SVG files instead of displaying them.
- **Additional Metrics**: Plot other metrics like population size or nutrient consumption.
- **Log Format Validation**: Add stricter validation for log file format to handle malformed entries.
- **Batch Processing**: Support processing multiple log files for comparative analysis.
- **Interactive Plots**: Use libraries like Plotly for interactive visualizations.
- **Performance Optimization**: Optimize parsing for large log files with thousands of entries.

## License

This project is licensed under the **MIT License**. See the `LICENSE` file in the main repository for details.

## Acknowledgments

- **Matplotlib**: For robust plotting capabilities.
- **Microorganisms Colony Simulator**: For generating the simulation logs this analyzer processes.
- **xAI**: Inspiration for scientific simulation tools.

---

Use this log analyzer to gain deeper insights into your microbial simulations! For issues or suggestions, open an issue in the repository or contact the maintainer.